<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>电商合理售价计算器（税务合规版）</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="container">
        <h2>电商合理售价计算器（税务合规版）</h2>
        
        <div class="tab-container">
            <div class="tabs">
                <button class="tab" onclick="switchTab('price')">售价计算</button>
                <button class="tab active" onclick="switchTab('profit')">利润计算</button>
            </div>
        </div>

        <!-- 售价计算tab -->
        <div id="priceTab" class="tab-content">
            <div class="section">
                <h3>第一步：基础成本</h3>
                <div class="step-description">
                    这部分是您需要支付给供应商的费用，包括商品本身的成本和相关税费。
                </div>
                <div class="input-groups-container">
                    <div class="input-group">
                        <label>进货价（不含税）:</label>
                        <div class="input-wrapper">
                            <input type="number" id="costPrice" value="100" step="0.01">
                            <button class="save-button" onclick="saveInputs()">保存</button>
                        </div>
                        <div class="field-hint">这是供应商提供的不含税商品价格</div>
                    </div>

                    <div class="input-group">
                        <label>开票成本（%）:</label>
                        <div class="input-wrapper">
                            <input type="number" id="inputTaxRate" value="6" step="0.1">
                            <button class="save-button" onclick="saveInputs()">保存</button>
                        </div>
                        <div class="field-hint">供应商开具发票时收取的额外费用比例（通常是6%）</div>
                    </div>

                    <div class="input-group">
                        <label>商品税率（%）:</label>
                        <div class="input-wrapper">
                            <input type="number" id="outputTaxRate" value="13" step="0.1">
                            <button class="save-button" onclick="saveInputs()">保存</button>
                        </div>
                        <div class="field-hint">商品的增值税税率（如服装类13%），这部分税费将来可以抵扣</div>
                    </div>
                </div>
                
                <div class="cost-summary" id="purchaseCostSummary" style="margin-top: 1rem; padding: 1rem; background: #f8f9fa; border-radius: 8px;">
                    <div class="summary-title">成本计算结果</div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                        <span>实际支付总额：</span>
                        <span id="totalPayment" style="font-weight: 500;">¥0.00</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; color: #2ea44f;">
                        <span>税后实际成本：</span>
                        <span id="effectiveCost" style="font-weight: 500;">¥0.00</span>
                    </div>
                    <div class="field-hint" style="margin-top: 0.5rem; font-size: 0.8rem;">
                        <div>• 实际支付总额 = 进货价 + 开票费用</div>
                        <div>• 税后实际成本 = 实际支付总额 - 可抵扣进项税</div>
                        <div>• 可抵扣进项税在销售时可以抵减应缴税款，相当于未来的税收优惠</div>
                    </div>
                </div>
            </div>

            <div class="section">
                <h3>第二步：销售环节费用</h3>
                <div class="step-description">
                    这部分是在销售过程中产生的各项费用，包括平台费用、物流费用和营销费用。
                </div>
                <div class="input-groups-container">
                    <div class="cost-category">
                        <div class="category-title">平台费用</div>
                        <div class="input-group">
                            <label>平台抽佣比例（%）:</label>
                            <div class="input-wrapper">
                                <input type="number" id="platformRate" value="5.5" step="0.1">
                                <button class="save-button" onclick="saveInputs()">保存</button>
                            </div>
                            <div class="field-hint">电商平台收取的交易佣金，基于最终售价（含税）计算</div>
                        </div>
                    </div>

                    <div class="cost-category">
                        <div class="category-title">物流费用</div>
                        <div class="input-group">
                            <label>物流费（元/单）:</label>
                            <div class="input-wrapper">
                                <input type="number" id="shippingCost" value="2.8" step="0.01">
                                <button class="save-button" onclick="saveInputs()">保存</button>
                            </div>
                            <div class="field-hint">每个订单的快递费用</div>
                        </div>

                        <div class="input-group">
                            <label>运费险（元/单）:</label>
                            <div class="input-wrapper">
                                <input type="number" id="shippingInsurance" value="1.5" step="0.01">
                                <button class="save-button" onclick="saveInputs()">保存</button>
                            </div>
                            <div class="field-hint">每个订单的运费险费用</div>
                        </div>
                    </div>

                    <div class="cost-category">
                        <div class="category-title">营销费用</div>
                        <div class="input-group">
                            <label>广告费用比例（%）:</label>
                            <div class="input-wrapper">
                                <input type="number" id="adRate" value="30" step="0.1">
                                <button class="save-button" onclick="saveInputs()">保存</button>
                            </div>
                            <div class="field-hint">广告费占最终售价的比例，可开具6%专票抵扣税款</div>
                        </div>
                    </div>

                    <div class="cost-category">
                        <div class="category-title">其他费用</div>
                        <div class="input-group">
                            <label>其他成本（元/单）:</label>
                            <div class="input-wrapper">
                                <input type="number" id="otherCost" value="2.5" step="0.01">
                                <button class="save-button" onclick="saveInputs()">保存</button>
                            </div>
                            <div class="field-hint">包装材料等其他固定成本</div>
                        </div>

                        <div class="input-group">
                            <label>销项税率（%）:</label>
                            <div class="input-wrapper">
                                <input type="number" id="salesTaxRate" value="13" step="0.1">
                                <button class="save-button" onclick="saveInputs()">保存</button>
                            </div>
                            <div class="field-hint">销项税率（如13%）。注意：销项税不是直接用含税价×13%，而是要先去税，即：含税价÷1.13×13%</div>
                        </div>
                    </div>
                </div>
                
                <div class="cost-summary" id="salesCostSummary" style="margin-top: 1rem; padding: 1rem; background: #f8f9fa; border-radius: 8px;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                        <span>固定成本（含退货分摊）：</span>
                        <span id="totalFixedCost" style="font-weight: 500;">¥0.00</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                        <span>平台佣金：</span>
                        <span id="platformFeePreview" style="font-weight: 500;">¥0.00</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                        <span>广告费：</span>
                        <span id="adCostPreview" style="font-weight: 500;">¥0.00</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                        <span>销项税（13%）：</span>
                        <span id="salesTax" style="font-weight: 500;">¥0.00</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; color: #2ea44f;">
                        <span>总销售成本：</span>
                        <span id="totalSalesCost" style="font-weight: 500;">¥0.00</span>
                    </div>
                    <div class="field-hint" style="margin-top: 0.5rem; font-size: 0.8rem;">
                        总销售成本 = 固定成本 + 平台佣金 + 广告费 + 销项税（基于最终售价）
                    </div>
                </div>
            </div>

            <div class="section">
                <h3>第三步：目标设定</h3>
                <div class="step-description">
                    设置您的经营目标和风险预期，这将影响最终售价的计算。
                </div>
                <div class="input-groups-container">
                    <div class="cost-category">
                        <div class="category-title">经营目标</div>
                        <div class="input-group">
                            <label>目标利润率（%）:</label>
                            <div class="input-wrapper">
                                <input type="number" id="targetProfitRate" value="8" step="0.1">
                                <button class="save-button" onclick="saveInputs()">保存</button>
                            </div>
                            <div class="field-hint">您期望的利润率，基于最终售价计算（例：8%意味着每100元售价中有8元是利润）</div>
                        </div>
                    </div>

                    <div class="cost-category">
                        <div class="category-title">风险预期</div>
                        <div class="input-group">
                            <label>预计退货率（%）:</label>
                            <div class="input-wrapper">
                                <input type="number" id="returnRate" value="20" step="0.1">
                                <button class="save-button" onclick="saveInputs()">保存</button>
                            </div>
                            <div class="field-hint">预计的退货率，影响成本分摊（例：20%意味着每100单中有20单会退货）</div>
                        </div>
                    </div>
                </div>
            </div>

            <button onclick="calculate()">计算售价</button>
        </div><!-- 结束售价计算tab -->

        <!-- 利润计算tab -->
        <div id="profitTab" class="tab-content active">
            <div class="section">
                <h3>利润计算</h3>
                <div class="step-description">
                    输入商品的进货价和实际售价，计算各项成本和最终利润。
                </div>
                <div class="input-groups-container">
                    <div class="input-group">
                        <label>进货价（不含税）:</label>
                        <div class="input-wrapper">
                            <input type="number" id="profitCostPrice" value="100" step="0.01">
                            <button class="save-button" onclick="saveInputs()">保存</button>
                        </div>
                        <div class="field-hint">这是供应商提供的不含税商品价格</div>
                    </div>

                    <div class="input-group">
                        <label>实际售价（含税）:</label>
                        <div class="input-wrapper">
                            <input type="number" id="actualPrice" value="200" step="0.01">
                            <button class="save-button" onclick="saveInputs()">保存</button>
                        </div>
                        <div class="field-hint">实际销售时的含税价格</div>
                    </div>

                    <div class="input-group">
                        <label>实际利润:</label>
                        <div class="input-wrapper" style="position: relative;">
                            <input type="text" id="actualProfit" readonly style="background-color: #f8f9fa; cursor: default;">
                            <div id="profitRate" style="position: absolute; right: 8px; top: 50%; transform: translateY(-50%); color: #2ea44f; font-size: 0.9rem;"></div>
                        </div>
                        <div class="field-hint" style="display: flex; justify-content: space-between;">
                            <span>计算得出的实际利润金额</span>
                            <span id="profitStatus" style="font-weight: 500;"></span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section">
                <h3>费用设置</h3>
                <div class="step-description">
                    设置各项费用参数，这些参数将影响最终的利润计算。
                </div>
                <div class="input-groups-container">
                    <div class="cost-category">
                        <div class="category-title">税费设置</div>
                        <div class="input-group">
                            <label>开票成本（%）:</label>
                            <div class="input-wrapper">
                                <input type="number" id="profitInputTaxRate" value="6" step="0.1">
                                <button class="save-button" onclick="saveInputs()">保存</button>
                            </div>
                            <div class="field-hint">供应商开具发票时收取的额外费用比例（通常是6%）</div>
                        </div>

                        <div class="input-group">
                            <label>商品进项税率（%）:</label>
                            <div class="input-wrapper">
                                <input type="number" id="profitOutputTaxRate" value="13" step="0.1">
                                <button class="save-button" onclick="saveInputs()">保存</button>
                            </div>
                            <div class="field-hint">商品的进项税率，用于计算可抵扣的进项税额（如服装类13%）</div>
                        </div>

                        <div class="input-group">
                            <label>销项税率（%）:</label>
                            <div class="input-wrapper">
                                <input type="number" id="profitSalesTaxRate" value="13" step="0.1">
                                <button class="save-button" onclick="saveInputs()">保存</button>
                            </div>
                            <div class="field-hint">销售时的增值税税率，通常与商品进项税率相同（如13%）</div>
                        </div>
                    </div>

                    <div class="cost-category">
                        <div class="category-title">平台费用</div>
                        <div class="input-group">
                            <label>平台抽佣比例（%）:</label>
                            <div class="input-wrapper">
                                <input type="number" id="profitPlatformRate" value="5.5" step="0.1">
                                <button class="save-button" onclick="saveInputs()">保存</button>
                            </div>
                            <div class="field-hint">电商平台收取的交易佣金，基于最终售价（含税）计算。平台开具6%专票，可抵扣进项税。</div>
                        </div>
                        <div style="margin-top: 0.5rem; padding: 0.5rem; background: #f0f7ff; border-radius: 4px; font-size: 0.85rem; color: #2ea44f;">
                            💡 提示：平台佣金可以获得6%的进项税抵扣，这部分抵扣会降低实际成本。
                        </div>
                    </div>

                    <div class="cost-category">
                        <div class="category-title">物流费用</div>
                        <div class="input-group">
                            <label>物流费（元/单）:</label>
                            <div class="input-wrapper">
                                <input type="number" id="profitShippingCost" value="2.8" step="0.01">
                                <button class="save-button" onclick="saveInputs()">保存</button>
                            </div>
                            <div class="field-hint">每个订单的快递费用</div>
                        </div>

                        <div class="input-group">
                            <label>运费险（元/单）:</label>
                            <div class="input-wrapper">
                                <input type="number" id="profitShippingInsurance" value="1.5" step="0.01">
                                <button class="save-button" onclick="saveInputs()">保存</button>
                            </div>
                            <div class="field-hint">每个订单的运费险费用</div>
                        </div>
                    </div>

                    <div class="cost-category">
                        <div class="category-title">营销费用</div>
                        <div class="input-group">
                            <label>广告费用比例（%）:</label>
                            <div class="input-wrapper">
                                <input type="number" id="profitAdRate" value="30" step="0.1">
                                <button class="save-button" onclick="saveInputs()">保存</button>
                            </div>
                            <div class="field-hint">广告费占最终售价的比例，广告服务商开具6%专票，可抵扣进项税。</div>
                        </div>
                        <div style="margin-top: 0.5rem; padding: 0.5rem; background: #f0f7ff; border-radius: 4px; font-size: 0.85rem; color: #2ea44f;">
                            💡 提示：广告费用可以获得6%的进项税抵扣。由于广告费金额较大，这部分抵扣会显著降低实际营销成本。
                        </div>
                    </div>

                    <div class="cost-category">
                        <div class="category-title">其他费用</div>
                        <div class="input-group">
                            <label>其他成本（元/单）:</label>
                            <div class="input-wrapper">
                                <input type="number" id="profitOtherCost" value="2.5" step="0.01">
                                <button class="save-button" onclick="saveInputs()">保存</button>
                            </div>
                            <div class="field-hint">包装材料等其他固定成本</div>
                        </div>
                    </div>

                    <div class="cost-category">
                        <div class="category-title">风险预期</div>
                        <div class="input-group">
                            <label>预计退货率（%）:</label>
                            <div class="input-wrapper">
                                <input type="number" id="profitReturnRate" value="20" step="0.1">
                                <button class="save-button" onclick="saveInputs()">保存</button>
                            </div>
                            <div class="field-hint">预计的退货率，影响成本分摊（例：20%意味着每100单中有20单会退货）</div>
                        </div>
                    </div>
                </div>
            </div>

            <button onclick="calculateProfit()">计算利润</button>
        </div>

        <div class="result" id="result"></div>
        
        <div class="description">
            <p>计算说明：</p>
            <ul>
                <li>进货价请填写不含税价格</li>
                <li>开票成本是供应商收取的开票费用比例（如6%）</li>
                <li>销项税率用于计算可抵扣的进项税额（如服装类目13%）</li>
                <li>计算结果已考虑开票成本、税费抵扣、平台抽佣等</li>
                <li>目标利润率基于最终售价计算</li>
            </ul>

            <p style="margin-top: 1.5rem; color: #0066cc;">重要提示：关于利润率计算</p>
            <ul style="color: #666;">
                <li>售价计算模块：
                    <ul>
                        <li>目标利润率是针对有效订单（扣除退货后）的利润率</li>
                        <li>系统会提高售价来补偿退货带来的损失</li>
                        <li>确保有效订单能达到设定的目标利润率</li>
                    </ul>
                </li>
                <li>利润计算模块：
                    <ul>
                        <li>显示整体业务的实际利润率（包含所有订单）</li>
                        <li>通常会高于售价计算的目标利润率</li>
                        <li>这是正常现象，因为售价中包含了退货补偿</li>
                    </ul>
                </li>
                <li>建议：
                    <ul>
                        <li>同时参考两个模块来评估定价策略</li>
                        <li>可以通过调整目标利润率来达到理想的整体利润水平</li>
                        <li>定期根据实际运营数据调整参数设置</li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>

    <script src="js/calculator.js"></script>
    <script src="js/result-template.js"></script>
    <script src="js/price-template.js"></script>
</body>
</html>