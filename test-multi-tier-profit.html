<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>多档利润率显示功能测试</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .test-section h2 {
            color: #555;
            margin-bottom: 15px;
        }
        .feature-description {
            background: #e8f4fd;
            border-left: 4px solid #2196f3;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }
        .feature-description h3 {
            margin-top: 0;
            color: #1976d2;
        }
        .feature-description ul {
            margin: 10px 0;
            padding-left: 20px;
        }
        .feature-description li {
            margin: 5px 0;
        }
        .catalog-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        .catalog-table th,
        .catalog-table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        .catalog-table th {
            background: #f8f9fa;
            font-weight: bold;
        }
        .catalog-table tr:nth-child(even) {
            background: #f9f9f9;
        }
        .demo-input {
            width: 80px;
            padding: 4px;
            border: 1px solid #ddd;
            border-radius: 4px;
            text-align: center;
        }
        .demo-button {
            background: #bfdbfe;
            color: #2563eb;
            border: none;
            padding: 4px 8px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 12px;
            margin: 2px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            line-height: 24px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .demo-remove-button {
            background: #fecaca;
            color: #dc2626;
        }
        .profit-rate-display {
            font-weight: 600;
            margin: 2px 0;
        }
        .profit-positive {
            color: #059669;
        }
        .profit-warning {
            color: #f59e0b;
        }
        .profit-negative {
            color: #dc2626;
        }
        .scenario-example {
            background: #f0f9ff;
            border: 1px solid #0ea5e9;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        .scenario-example h4 {
            margin-top: 0;
            color: #0369a1;
        }
        .scenario-example .example-data {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            padding: 10px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>多档利润率显示功能测试</h1>
        
        <div class="feature-description">
            <h3>功能说明</h3>
            <p>已为商品清单表格的利润率列添加多档显示功能：</p>
            <ul>
                <li><strong>多档售价 + 多档进货价</strong>：显示对应档位的利润率</li>
                <li><strong>多档售价 + 单档进货价</strong>：显示每档售价的利润率</li>
                <li><strong>单档售价 + 多档进货价</strong>：显示每档进货价的利润率</li>
                <li><strong>单档售价 + 单档进货价</strong>：显示单一利润率</li>
                <li><strong>智能计算</strong>：自动识别档位数量并计算对应利润率</li>
            </ul>
        </div>

        <div class="test-section">
            <h2>功能演示</h2>
            <p>以下是不同档位配置的利润率显示示例：</p>
            
            <table class="catalog-table">
                <thead>
                    <tr>
                        <th style="width:36px; text-align:center;">
                            <input type="checkbox">
                        </th>
                        <th style="width:120px;">商品名称</th>
                        <th style="width:100px;">货号</th>
                        <th style="width:80px;">平台</th>
                        <th style="width:80px;">含税售价P</th>
                        <th style="width:180px;">含税售价（多档）</th>
                        <th style="width:140px;">进货价（多档）</th>
                        <th style="width:70px;">退货率</th>
                        <th style="width:100px;">保本ROI</th>
                        <th style="width:120px;">保本广告占比</th>
                        <th style="width:100px;">利润率(20%付费)</th>
                        <th style="width:140px;">操作</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td style="text-align:center;">
                            <input type="checkbox">
                        </td>
                        <td>色纱空气层单裤</td>
                        <td>FWL240331</td>
                        <td>淘宝</td>
                        <td style="text-align:right;">0</td>
                        <td style="text-align:right;">
                            <div style="display:flex; flex-direction:column; gap:4px;">
                                <div style="display:flex; align-items:center; gap:8px;">
                                    <button class="demo-button">+</button>
                                    <div>
                                        <div style="display:flex; gap:6px; align-items:center; margin:2px 0;">
                                            <input type="number" class="demo-input" value="59.80" readonly>
                                            <button class="demo-button demo-remove-button">×</button>
                                        </div>
                                        <div style="display:flex; gap:6px; align-items:center; margin:2px 0;">
                                            <input type="number" class="demo-input" value="65.80" readonly>
                                            <button class="demo-button demo-remove-button">×</button>
                                        </div>
                                        <div style="display:flex; gap:6px; align-items:center; margin:2px 0;">
                                            <input type="number" class="demo-input" value="69.80" readonly>
                                            <button class="demo-button demo-remove-button">×</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </td>
                        <td style="text-align:right;">
                            <div style="display:flex; flex-direction:column; gap:4px;">
                                <div style="display:flex; align-items:center; gap:8px;">
                                    <button class="demo-button">+</button>
                                    <div>
                                        <div style="display:flex; gap:6px; align-items:center; margin:2px 0;">
                                            <input type="number" class="demo-input" value="27.00" readonly>
                                            <button class="demo-button demo-remove-button">×</button>
                                        </div>
                                        <div style="display:flex; gap:6px; align-items:center; margin:2px 0;">
                                            <input type="number" class="demo-input" value="29.50" readonly>
                                            <button class="demo-button demo-remove-button">×</button>
                                        </div>
                                        <div style="display:flex; gap:6px; align-items:center; margin:2px 0;">
                                            <input type="number" class="demo-input" value="32.00" readonly>
                                            <button class="demo-button demo-remove-button">×</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </td>
                        <td style="text-align:right;">
                            <input type="text" class="demo-input" value="23.15%" readonly>
                        </td>
                        <td style="text-align:right;">2.50</td>
                        <td style="text-align:right;">25.00%</td>
                        <td style="text-align:right;">
                            <div class="profit-rate-display profit-positive">15.80%</div>
                            <div class="profit-rate-display profit-positive">18.20%</div>
                            <div class="profit-rate-display profit-positive">20.10%</div>
                        </td>
                        <td style="text-align:center;">
                            <button style="background:#007bff; color:white; border:none; padding:4px 8px; border-radius:4px; cursor:pointer;">价格验证</button>
                            <button style="background:#28a745; color:white; border:none; padding:4px 8px; border-radius:4px; cursor:pointer; margin-left:4px;">利润推演</button>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align:center;">
                            <input type="checkbox">
                        </td>
                        <td>德绒背心</td>
                        <td>HYX2140</td>
                        <td>淘宝</td>
                        <td style="text-align:right;">79</td>
                        <td style="text-align:right;">
                            <div style="display:flex; flex-direction:column; gap:4px;">
                                <div style="display:flex; align-items:center; gap:8px;">
                                    <button class="demo-button">+</button>
                                    <div>
                                        <div style="display:flex; gap:6px; align-items:center; margin:2px 0;">
                                            <input type="number" class="demo-input" value="79" readonly>
                                            <button class="demo-button demo-remove-button">×</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </td>
                        <td style="text-align:right;">
                            <div style="display:flex; flex-direction:column; gap:4px;">
                                <div style="display:flex; align-items:center; gap:8px;">
                                    <button class="demo-button">+</button>
                                    <div>
                                        <div style="display:flex; gap:6px; align-items:center; margin:2px 0;">
                                            <input type="number" class="demo-input" value="24.30" readonly>
                                            <button class="demo-button demo-remove-button">×</button>
                                        </div>
                                        <div style="display:flex; gap:6px; align-items:center; margin:2px 0;">
                                            <input type="number" class="demo-input" value="30.30" readonly>
                                            <button class="demo-button demo-remove-button">×</button>
                                        </div>
                                        <div style="display:flex; gap:6px; align-items:center; margin:2px 0;">
                                            <input type="number" class="demo-input" value="33.80" readonly>
                                            <button class="demo-button demo-remove-button">×</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </td>
                        <td style="text-align:right;">
                            <input type="text" class="demo-input" value="9.14%" readonly>
                        </td>
                        <td style="text-align:right;">3.20</td>
                        <td style="text-align:right;">30.00%</td>
                        <td style="text-align:right;">
                            <div class="profit-rate-display profit-positive">25.80%</div>
                            <div class="profit-rate-display profit-positive">22.10%</div>
                            <div class="profit-rate-display profit-positive">20.50%</div>
                        </td>
                        <td style="text-align:center;">
                            <button style="background:#007bff; color:white; border:none; padding:4px 8px; border-radius:4px; cursor:pointer;">价格验证</button>
                            <button style="background:#28a745; color:white; border:none; padding:4px 8px; border-radius:4px; cursor:pointer; margin-left:4px;">利润推演</button>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align:center;">
                            <input type="checkbox">
                        </td>
                        <td>摇粒绒马甲</td>
                        <td>HYXB50001</td>
                        <td>淘宝</td>
                        <td style="text-align:right;">58</td>
                        <td style="text-align:right;">
                            <div style="display:flex; flex-direction:column; gap:4px;">
                                <div style="display:flex; align-items:center; gap:8px;">
                                    <button class="demo-button">+</button>
                                    <div>
                                        <div style="display:flex; gap:6px; align-items:center; margin:2px 0;">
                                            <input type="number" class="demo-input" value="58" readonly>
                                            <button class="demo-button demo-remove-button">×</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </td>
                        <td style="text-align:right;">
                            <div style="display:flex; flex-direction:column; gap:4px;">
                                <div style="display:flex; align-items:center; gap:8px;">
                                    <button class="demo-button">+</button>
                                    <div>
                                        <div style="display:flex; gap:6px; align-items:center; margin:2px 0;">
                                            <input type="number" class="demo-input" value="22.5" readonly>
                                            <button class="demo-button demo-remove-button">×</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </td>
                        <td style="text-align:right;">
                            <input type="text" class="demo-input" value="13.99%" readonly>
                        </td>
                        <td style="text-align:right;">2.50</td>
                        <td style="text-align:right;">25.00%</td>
                        <td style="text-align:right;">
                            <div class="profit-rate-display profit-positive">18.50%</div>
                        </td>
                        <td style="text-align:center;">
                            <button style="background:#007bff; color:white; border:none; padding:4px 8px; border-radius:4px; cursor:pointer;">价格验证</button>
                            <button style="background:#28a745; color:white; border:none; padding:4px 8px; border-radius:4px; cursor:pointer; margin-left:4px;">利润推演</button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="test-section">
            <h2>多档利润率计算逻辑</h2>
            
            <div class="scenario-example">
                <h4>1. 多档售价 + 多档进货价</h4>
                <p>档位一一对应，计算每档的利润率：</p>
                <div class="example-data">
                    售价档位1: 59.80 → 进货价档位1: 27.00 → 利润率: 15.80%<br>
                    售价档位2: 65.80 → 进货价档位2: 29.50 → 利润率: 18.20%<br>
                    售价档位3: 69.80 → 进货价档位3: 32.00 → 利润率: 20.10%
                </div>
            </div>
            
            <div class="scenario-example">
                <h4>2. 单档售价 + 多档进货价</h4>
                <p>固定售价，计算不同进货价的利润率：</p>
                <div class="example-data">
                    售价: 79.00 → 进货价档位1: 24.30 → 利润率: 25.80%<br>
                    售价: 79.00 → 进货价档位2: 30.30 → 利润率: 22.10%<br>
                    售价: 79.00 → 进货价档位3: 33.80 → 利润率: 20.50%
                </div>
            </div>
            
            <div class="scenario-example">
                <h4>3. 单档售价 + 单档进货价</h4>
                <p>传统单一利润率计算：</p>
                <div class="example-data">
                    售价: 58.00 → 进货价: 22.50 → 利润率: 18.50%
                </div>
            </div>
        </div>

        <div class="test-section">
            <h2>技术实现</h2>
            <p><strong>主要功能：</strong></p>
            <ul>
                <li><strong>智能档位识别</strong>：自动检测售价和进货价的档位数量</li>
                <li><strong>多档计算</strong>：支持多种档位组合的利润率计算</li>
                <li><strong>统一算法</strong>：使用 <code>calculateProfitUnified()</code> 函数确保计算一致性</li>
                <li><strong>动态显示</strong>：根据档位数量自动调整显示格式</li>
                <li><strong>样式保持</strong>：保持原有的颜色编码和警告提示</li>
            </ul>
            
            <p><strong>计算规则：</strong></p>
            <ol>
                <li><strong>档位匹配</strong>：多档对多档时，取最小长度进行一一对应计算</li>
                <li><strong>固定参数</strong>：付费占比固定为20%，其他参数使用行内或全局默认值</li>
                <li><strong>错误处理</strong>：无效数据时显示友好的错误提示</li>
                <li><strong>性能优化</strong>：避免重复计算，提高响应速度</li>
            </ol>
        </div>
    </div>
</body>
</html>
