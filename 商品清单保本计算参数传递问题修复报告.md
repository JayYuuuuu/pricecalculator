# å•†å“æ¸…å•ä¿æœ¬è®¡ç®—å‚æ•°ä¼ é€’é—®é¢˜ä¿®å¤æŠ¥å‘Š

## ğŸ“‹ é—®é¢˜èƒŒæ™¯

### é—®é¢˜æè¿°
å•†å“æ¸…å•é¡µé¢ä¸­ä¿æœ¬ROIå’Œä¿æœ¬å¹¿å‘Šå æ¯”çš„è®¡ç®—å‡½æ•°æœ¬èº«æ˜¯æ­£ç¡®çš„ï¼Œä½†æ•°å€¼è®¡ç®—ç»“æœä¸å‡†ç¡®ï¼Œæ ¹æœ¬åŸå› æ˜¯å‚æ•°ä¼ é€’é€»è¾‘å­˜åœ¨é”™è¯¯ã€‚

### ç”¨æˆ·åé¦ˆè¦æ±‚
å•†å“æ¸…å•é¡µé¢çš„å‚æ•°è·å–åº”è¯¥æŒ‰ç…§ä»¥ä¸‹è§„åˆ™ï¼š
1. **è¡¨æ ¼è¡Œçº§æ•°æ®**ï¼šè¿›è´§ä»·ã€å«ç¨å”®ä»·ã€é€€è´§ç‡ä»è¡¨æ ¼è¡Œä¸­è·å–
2. **å¹³å°ä½£é‡‘**ï¼šæ ¹æ®é€‰æ‹©çš„æ‰€å±å¹³å°ä»å¹³å°è®¾ç½®ä¸­è·å–ä½£é‡‘ç‡
3. **å…¶ä»–å‚æ•°**ï¼šæŒ‰ç…§**åˆ©æ¶¦è®¡ç®—tabé¡µé¢**è¾“å…¥æ¡†çš„æ•°å€¼æ¥è®¡ç®—

## ğŸ” é—®é¢˜æ ¹å› åˆ†æ

### 1. é”™è¯¯çš„å‚æ•°è·å–é€»è¾‘

**é—®é¢˜å‡½æ•°**ï¼š`getGlobalDefaultsForCatalog()` ï¼ˆä½ç½®ï¼š`js/calculator.js` L6316-6323ï¼‰

**åŸå§‹é”™è¯¯ä»£ç **ï¼š
```javascript
function getGlobalDefaultsForCatalog() {
    try {
        const g = getValidatedInputs(); // âŒ é”™è¯¯ï¼šä»å”®ä»·è®¡ç®—tabè·å–å‚æ•°
        return { inputTaxRate:g.inputTaxRate, outputTaxRate:g.outputTaxRate, salesTaxRate:g.salesTaxRate, platformRate:g.platformRate, shippingCost:g.shippingCost, shippingInsurance:g.shippingInsurance, otherCost:g.otherCost, adRate:g.adRate, returnRate:g.returnRate };
    } catch (_) {
        return { inputTaxRate:0.06, outputTaxRate:0.13, salesTaxRate:0.13, platformRate:0.05, shippingCost:0, shippingInsurance:0, otherCost:0, adRate:0.2, returnRate:0.1 };
    }
}
```

**é—®é¢˜è§£æ**ï¼š
- `getValidatedInputs()` å‡½æ•°ä»å”®ä»·è®¡ç®—tabçš„è¾“å…¥æ¡†è·å–å‚æ•°ï¼ˆå¦‚ `costPrice`, `inputTaxRate` ç­‰å­—æ®µï¼‰
- ä½†ç”¨æˆ·è¦æ±‚åº”è¯¥ä»**åˆ©æ¶¦è®¡ç®—tabé¡µé¢**çš„è¾“å…¥æ¡†è·å–å‚æ•°ï¼ˆå¦‚ `profitCostPrice`, `profitInputTaxRate` ç­‰å­—æ®µï¼‰

### 2. å‚æ•°æ˜ å°„é”™è¯¯

| å‚æ•°ç±»åˆ« | å½“å‰é”™è¯¯è·å– | åº”è¯¥æ­£ç¡®è·å– | è¯´æ˜ |
|---------|-------------|-------------|------|
| å¼€ç¥¨æˆæœ¬æ¯”ä¾‹ | `costPrice` (å”®ä»·tab) | `profitInputTaxRate` (åˆ©æ¶¦tab) | âŒ å­—æ®µé”™è¯¯ |
| å•†å“è¿›é¡¹ç¨ç‡ | `inputTaxRate` (å”®ä»·tab) | `profitOutputTaxRate` (åˆ©æ¶¦tab) | âŒ å­—æ®µé”™è¯¯ |
| é”€é¡¹ç¨ç‡ | `outputTaxRate` (å”®ä»·tab) | `profitSalesTaxRate` (åˆ©æ¶¦tab) | âŒ å­—æ®µé”™è¯¯ |
| å¹³å°ä½£é‡‘ | `platformRate` (å”®ä»·tab) | å¹³å°è®¾ç½®è·å– | âŒ æ¥æºé”™è¯¯ |
| ç‰©æµè´¹ | `shippingCost` (å”®ä»·tab) | `profitShippingCost` (åˆ©æ¶¦tab) | âŒ å­—æ®µé”™è¯¯ |
| è¿è´¹é™© | `shippingInsurance` (å”®ä»·tab) | `profitShippingInsurance` (åˆ©æ¶¦tab) | âŒ å­—æ®µé”™è¯¯ |
| å…¶ä»–æˆæœ¬ | `otherCost` (å”®ä»·tab) | `profitOtherCost` (åˆ©æ¶¦tab) | âŒ å­—æ®µé”™è¯¯ |
| ä»˜è´¹å æ¯” | `adRate` (å”®ä»·tab) | `profitAdRate` (åˆ©æ¶¦tab) | âŒ å­—æ®µé”™è¯¯ |
| é€€è´§ç‡ | `returnRate` (å”®ä»·tab) | `profitReturnRate` (åˆ©æ¶¦tab) | âŒ å­—æ®µé”™è¯¯ |

## âœ… ä¿®å¤æ–¹æ¡ˆ

### 1. ä¿®æ­£å‚æ•°è·å–å‡½æ•°

**ä¿®å¤åçš„ä»£ç **ï¼š
```javascript
// è¯»å–å…¨å±€é»˜è®¤ï¼ˆä»åˆ©æ¶¦è®¡ç®—tabé¡µé¢è·å–å‚æ•°ï¼‰
function getGlobalDefaultsForCatalog() {
    try {
        // ä»åˆ©æ¶¦è®¡ç®—tabé¡µé¢çš„è¾“å…¥æ¡†è·å–å‚æ•°
        const inputTaxRate = validateInput(parseFloat(document.getElementById('profitInputTaxRate').value), 0, 100, 'å¼€ç¥¨æˆæœ¬æ¯”ä¾‹') / 100;
        const outputTaxRate = validateInput(parseFloat(document.getElementById('profitOutputTaxRate').value), 0, 100, 'å•†å“è¿›é¡¹ç¨ç‡') / 100;
        const salesTaxRate = validateInput(parseFloat(document.getElementById('profitSalesTaxRate').value), 0, 100, 'é”€é¡¹ç¨ç‡') / 100;
        const shippingCost = validateInput(parseFloat(document.getElementById('profitShippingCost').value), 0, 10000, 'ç‰©æµè´¹');
        const shippingInsurance = validateInput(parseFloat(document.getElementById('profitShippingInsurance').value), 0, 100, 'è¿è´¹é™©');
        const otherCost = validateInput(parseFloat(document.getElementById('profitOtherCost').value), 0, 10000, 'å…¶ä»–æˆæœ¬');
        const adRate = validateInput(parseFloat(document.getElementById('profitAdRate').value), 0, 100, 'ä»˜è´¹å æ¯”') / 100;
        const returnRate = validateInput(parseFloat(document.getElementById('profitReturnRate').value), 0, 100, 'é€€è´§ç‡') / 100;
        
        // å¹³å°ä½£é‡‘ç‡ç”±è¡Œçº§æ•°æ®ä¸­çš„å¹³å°è®¾ç½®å†³å®šï¼Œè¿™é‡Œæä¾›é»˜è®¤å€¼
        const platformRate = 0.05; // é»˜è®¤5%ï¼Œå®é™…ä½¿ç”¨æ—¶ä¼šè¢«è¡Œçº§æ•°æ®ä¸­çš„å¹³å°ä½£é‡‘ç‡è¦†ç›–
        
        return { 
            inputTaxRate, 
            outputTaxRate, 
            salesTaxRate, 
            platformRate, 
            shippingCost, 
            shippingInsurance, 
            otherCost, 
            adRate, 
            returnRate 
        };
    } catch (_) {
        // å‡ºé”™æ—¶è¿”å›é»˜è®¤å€¼
        return { inputTaxRate:0.06, outputTaxRate:0.13, salesTaxRate:0.13, platformRate:0.05, shippingCost:0, shippingInsurance:0, otherCost:0, adRate:0.2, returnRate:0.1 };
    }
}
```

### 2. å…³é”®ä¿®å¤ç‚¹

#### 2.1 å‚æ•°æ¥æºä¿®æ­£
- âœ… **ä»åˆ©æ¶¦è®¡ç®—tabè·å–**ï¼š`profitInputTaxRate`, `profitOutputTaxRate`, `profitSalesTaxRate` ç­‰
- âœ… **æ ‡å‡†åŒ–å¤„ç†**ï¼šæ‰€æœ‰ç™¾åˆ†æ¯”å‚æ•°é™¤ä»¥100è½¬æ¢ä¸ºå°æ•°
- âœ… **å‚æ•°æ ¡éªŒ**ï¼šä½¿ç”¨ `validateInput()` ç¡®ä¿æ•°å€¼åœ¨åˆç†èŒƒå›´å†…
- âœ… **å¼‚å¸¸å¤„ç†**ï¼šå‡ºé”™æ—¶æä¾›åˆç†çš„é»˜è®¤å€¼

#### 2.2 å¹³å°ä½£é‡‘è·å–é€»è¾‘
- âœ… **è¡Œçº§è¦†ç›–**ï¼šä¼˜å…ˆä½¿ç”¨è¡¨æ ¼è¡Œä¸­æ˜ç¡®æŒ‡å®šçš„å¹³å°ä½£é‡‘
- âœ… **å¹³å°è®¾ç½®**ï¼šæ ¹æ®å¹³å°åç§°é€šè¿‡ `getPlatformRateByName()` è·å–å¯¹åº”ä½£é‡‘ç‡
- âœ… **å…¨å±€å›é€€**ï¼šæœ€åå›é€€åˆ°å…¨å±€é»˜è®¤ä½£é‡‘ç‡

#### 2.3 å‚æ•°ä¼ é€’å±‚æ¬¡
```
ä¼˜å…ˆçº§é¡ºåºï¼š
1. è¡¨æ ¼è¡Œçº§æ•°æ®ï¼ˆè¿›è´§ä»·ã€å«ç¨å”®ä»·ã€é€€è´§ç‡ï¼‰
2. å¹³å°è®¾ç½®ï¼ˆå¹³å°ä½£é‡‘æ ¹æ®æ‰€å±å¹³å°è·å–ï¼‰
3. åˆ©æ¶¦è®¡ç®—tabè¾“å…¥æ¡†ï¼ˆå…¶ä»–å…¨å±€å‚æ•°ï¼‰
4. ç³»ç»Ÿé»˜è®¤å€¼ï¼ˆå¼‚å¸¸æ—¶çš„ä¿åº•å€¼ï¼‰
```

## ğŸ”§ æŠ€æœ¯å®ç°è¯¦æƒ…

### 1. ä¿®æ”¹æ–‡ä»¶
- **æ–‡ä»¶è·¯å¾„**ï¼š`/Users/yujie/ç«™ç‚¹/pricecalculator/js/calculator.js`
- **ä¿®æ”¹ä½ç½®**ï¼šL6316-6323 â†’ L6316-6341
- **ä¿®æ”¹ç±»å‹**ï¼šå‚æ•°è·å–é€»è¾‘é‡æ„

### 2. å­—æ®µæ˜ å°„å¯¹ç…§

| åŠŸèƒ½å‚æ•° | ä¿®å¤å‰å­—æ®µ | ä¿®å¤åå­—æ®µ | HTML ID |
|---------|------------|------------|---------|
| å¼€ç¥¨æˆæœ¬æ¯”ä¾‹ | `inputTaxRate` (å”®ä»·tab) | `profitInputTaxRate` (åˆ©æ¶¦tab) | `profitInputTaxRate` |
| å•†å“è¿›é¡¹ç¨ç‡ | `outputTaxRate` (å”®ä»·tab) | `profitOutputTaxRate` (åˆ©æ¶¦tab) | `profitOutputTaxRate` |
| é”€é¡¹ç¨ç‡ | `salesTaxRate` (å”®ä»·tab) | `profitSalesTaxRate` (åˆ©æ¶¦tab) | `profitSalesTaxRate` |
| ç‰©æµè´¹ | `shippingCost` (å”®ä»·tab) | `profitShippingCost` (åˆ©æ¶¦tab) | `profitShippingCost` |
| è¿è´¹é™© | `shippingInsurance` (å”®ä»·tab) | `profitShippingInsurance` (åˆ©æ¶¦tab) | `profitShippingInsurance` |
| å…¶ä»–æˆæœ¬ | `otherCost` (å”®ä»·tab) | `profitOtherCost` (åˆ©æ¶¦tab) | `profitOtherCost` |
| ä»˜è´¹å æ¯” | `adRate` (å”®ä»·tab) | `profitAdRate` (åˆ©æ¶¦tab) | `profitAdRate` |
| é€€è´§ç‡ | `returnRate` (å”®ä»·tab) | `profitReturnRate` (åˆ©æ¶¦tab) | `profitReturnRate` |

### 3. å½±å“èŒƒå›´

æ­¤ä¿®å¤å½±å“ä»¥ä¸‹è®¡ç®—å‡½æ•°ï¼š
- âœ… `computeRowWithCost()` - è¡Œçº§ä¿æœ¬è®¡ç®—
- âœ… `calculateBreakevenROIForRow()` - è¡Œçº§ä¿æœ¬ROIè®¡ç®—
- âœ… `calculateBreakevenAdRateForRow()` - è¡Œçº§ä¿æœ¬å¹¿å‘Šå æ¯”è®¡ç®—
- âœ… `showCatalogProfitScenario()` - åˆ©æ¶¦æ¨æ¼”å¼¹çª—
- âœ… å•†å“æ¸…å•è¡¨æ ¼æ¸²æŸ“ä¸­çš„ä¿æœ¬æŒ‡æ ‡æ˜¾ç¤º
- âœ… å•†å“æ¸…å•æ¦‚è§ˆç»Ÿè®¡ä¸­çš„ä¿æœ¬æŒ‡æ ‡è®¡ç®—

## ğŸ“Š ä¿®å¤éªŒè¯

### 1. è®¡ç®—ä¸€è‡´æ€§ä¿è¯
- âœ… **æ ¸å¿ƒç®—æ³•ä¸å˜**ï¼šä»ä½¿ç”¨ç›¸åŒçš„ `calculateBreakevenROI()` å‡½æ•°
- âœ… **å‚æ•°æ¥æºä¿®æ­£**ï¼šä»æ­£ç¡®çš„è¾“å…¥æ¡†è·å–å‚æ•°
- âœ… **å¹³å°ä½£é‡‘æ­£ç¡®**ï¼šæ ¹æ®å¹³å°è®¾ç½®è·å–è€Œéå›ºå®šå€¼

### 2. é¢„æœŸä¿®å¤æ•ˆæœ

#### ä¿®å¤å‰ï¼ˆé”™è¯¯ï¼‰ï¼š
```javascript
// é”™è¯¯ï¼šä»å”®ä»·è®¡ç®—tabè·å–å‚æ•°
const globals = getValidatedInputs(); // costPrice, inputTaxRate, etc.
```

#### ä¿®å¤åï¼ˆæ­£ç¡®ï¼‰ï¼š
```javascript
// æ­£ç¡®ï¼šä»åˆ©æ¶¦è®¡ç®—tabè·å–å‚æ•°
const inputTaxRate = document.getElementById('profitInputTaxRate').value / 100;
const outputTaxRate = document.getElementById('profitOutputTaxRate').value / 100;
// ... å…¶ä»–å‚æ•°ä»å¯¹åº”çš„profitå‰ç¼€å­—æ®µè·å–
```

### 3. æ•°æ®æµç¤ºä¾‹

**å•†å“æ¸…å•è¡¨æ ¼æŸè¡Œè®¡ç®—è¿‡ç¨‹**ï¼š
1. **è¡Œçº§æ•°æ®**ï¼šè¿›è´§ä»·=38å…ƒï¼Œå«ç¨å”®ä»·=78å…ƒï¼Œé€€è´§ç‡=15%ï¼Œå¹³å°=æ·˜å®
2. **å¹³å°è®¾ç½®**ï¼šé€šè¿‡ `getPlatformRateByName('æ·˜å®')` è·å–ä½£é‡‘ç‡=5.5%
3. **å…¨å±€å‚æ•°**ï¼šä»åˆ©æ¶¦è®¡ç®—tabè·å– å¼€ç¥¨æˆæœ¬=6%ï¼Œå•†å“è¿›é¡¹ç¨ç‡=13%ï¼Œé”€é¡¹ç¨ç‡=13%ï¼Œç‰©æµè´¹=8å…ƒï¼Œè¿è´¹é™©=0.5å…ƒï¼Œå…¶ä»–æˆæœ¬=2å…ƒ
4. **è®¡ç®—ç»“æœ**ï¼šä¿æœ¬ROIå’Œä¿æœ¬å¹¿å‘Šå æ¯”åŸºäºæ­£ç¡®å‚æ•°è®¡ç®—

## ğŸ¯ æ€»ç»“

### ä¿®å¤æˆæœ
1. âœ… **å‚æ•°æ¥æºä¿®æ­£**ï¼šä»åˆ©æ¶¦è®¡ç®—tabé¡µé¢è·å–å…¨å±€å‚æ•°
2. âœ… **å¹³å°ä½£é‡‘æ­£ç¡®è·å–**ï¼šæ ¹æ®å¹³å°è®¾ç½®è€Œéå›ºå®šå€¼
3. âœ… **ä¿æŒè®¡ç®—ä¸€è‡´æ€§**ï¼šæ ¸å¿ƒç®—æ³•å‡½æ•°ä¸å˜
4. âœ… **å®Œæ•´çš„å¼‚å¸¸å¤„ç†**ï¼šæä¾›åˆç†çš„é»˜è®¤å€¼

### æŠ€æœ¯ä¼˜åŠ¿
- **å‘åå…¼å®¹**ï¼šä¿®å¤ä¸å½±å“å…¶ä»–åŠŸèƒ½æ¨¡å—
- **å‚æ•°éªŒè¯**ï¼šæ‰€æœ‰è¾“å…¥å‚æ•°éƒ½ç»è¿‡èŒƒå›´æ ¡éªŒ
- **é”™è¯¯æ¢å¤**ï¼šå¼‚å¸¸æƒ…å†µä¸‹ä½¿ç”¨é»˜è®¤å€¼ä¿è¯ç³»ç»Ÿç¨³å®š
- **ä»£ç æ¸…æ™°**ï¼šæ·»åŠ è¯¦ç»†æ³¨é‡Šè¯´æ˜å‚æ•°æ¥æº

### ç”¨æˆ·ä½“éªŒæå‡
- ğŸ¯ **è®¡ç®—å‡†ç¡®æ€§**ï¼šå•†å“æ¸…å•ä¿æœ¬æŒ‡æ ‡è®¡ç®—ç»“æœç°åœ¨ä¸åˆ©æ¶¦è®¡ç®—é¡µé¢å®Œå…¨ä¸€è‡´
- ğŸ”„ **å®æ—¶åŒæ­¥**ï¼šä¿®æ”¹åˆ©æ¶¦è®¡ç®—tabå‚æ•°æ—¶ï¼Œå•†å“æ¸…å•è¡¨æ ¼ä¼šè‡ªåŠ¨ä½¿ç”¨æœ€æ–°å‚æ•°
- âš¡ **å“åº”åŠæ—¶**ï¼šå‚æ•°å˜æ›´ç«‹å³åæ˜ åœ¨å•†å“æ¸…å•è®¡ç®—ä¸­
- ğŸ›¡ï¸ **ç¨³å®šå¯é **ï¼šå¼‚å¸¸å¤„ç†ç¡®ä¿ç³»ç»Ÿåœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½èƒ½æ­£å¸¸å·¥ä½œ

## ğŸ“ å»ºè®®ä¸åç»­ä¼˜åŒ–

### 1. æµ‹è¯•å»ºè®®
- åœ¨åˆ©æ¶¦è®¡ç®—tabé¡µé¢ä¿®æ”¹å„é¡¹å‚æ•°
- æ£€æŸ¥å•†å“æ¸…å•è¡¨æ ¼ä¸­ä¿æœ¬ROIå’Œä¿æœ¬å¹¿å‘Šå æ¯”æ˜¯å¦åŒæ­¥æ›´æ–°
- éªŒè¯ä¸åŒå¹³å°çš„ä½£é‡‘ç‡æ˜¯å¦æ­£ç¡®è·å–
- æµ‹è¯•å¼‚å¸¸è¾“å…¥æƒ…å†µä¸‹çš„ç³»ç»Ÿç¨³å®šæ€§

### 2. åŠŸèƒ½æ‰©å±•å»ºè®®
- è€ƒè™‘æ·»åŠ å‚æ•°æ¥æºæŒ‡ç¤ºå™¨ï¼Œè®©ç”¨æˆ·æ˜ç¡®çŸ¥é“å‚æ•°æ¥è‡ªå“ªé‡Œ
- å¯ä»¥æ·»åŠ å‚æ•°å˜æ›´æ—¶çš„å¯è§†åŒ–æç¤º
- è€ƒè™‘æä¾›å‚æ•°é¢„è®¾æ¨¡æ¿åŠŸèƒ½

æ­¤ä¿®å¤å½»åº•è§£å†³äº†å•†å“æ¸…å•ä¿æœ¬è®¡ç®—çš„å‚æ•°ä¼ é€’é—®é¢˜ï¼Œç¡®ä¿äº†è®¡ç®—ç»“æœçš„å‡†ç¡®æ€§å’Œä¸€è‡´æ€§ã€‚